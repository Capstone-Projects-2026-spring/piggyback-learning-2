"use strict";(self.webpackChunkcreate_project_docs=self.webpackChunkcreate_project_docs||[]).push([[3791],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>d});var s=i(96540);const a={},t=s.createContext(a);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},48760:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"system-architecture/design","title":"Design","description":"Components","source":"@site/docs/system-architecture/design.md","sourceDirName":"system-architecture","slug":"/system-architecture/design","permalink":"/piggyback-learning-2/docs/system-architecture/design","draft":false,"unlisted":false,"editUrl":"https://github.com/Capstone-Projects-2026-spring/piggyback-learning-2/edit/main/documentation/docs/system-architecture/design.md","tags":[],"version":"current","lastUpdatedBy":"ayushgupta0010","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"System Architecture","permalink":"/piggyback-learning-2/docs/category/system-architecture"},"next":{"title":"Development Environment","permalink":"/piggyback-learning-2/docs/system-architecture/development-environment"}}');var a=i(74848),t=i(28453);const r={sidebar_position:1},d="Design",l={},o=[{value:"Components",id:"components",level:2},{value:"Database",id:"database",level:3},{value:"Entity Relationship Diagram:",id:"entity-relationship-diagram",level:3},{value:"Piggyback Learning API",id:"piggyback-learning-api",level:2},{value:"Use Case Sequence Diagrams",id:"use-case-sequence-diagrams",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"design",children:"Design"})}),"\n",(0,a.jsx)(n.h2,{id:"components",children:"Components"}),"\n",(0,a.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,a.jsx)(n.h3,{id:"entity-relationship-diagram",children:"Entity Relationship Diagram:"}),"\n",(0,a.jsx)(n.mermaid,{value:"erDiagram\n    USERS {\n        INTEGER id PK\n        VARCHAR email\n        VARCHAR username\n        VARCHAR password_hash\n        INTEGER role_id FK\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n        TIMESTAMP last_login\n    }\n\n    USER_PROFILES {\n        INTEGER id PK\n        INTEGER user_id FK\n        VARCHAR first_name\n        VARCHAR last_name\n        TIMESTAMP date_of_birth\n    }\n\n    ROLES {\n        INTEGER id PK\n        VARCHAR role_type\n    }\n\n    VIDEOS {\n        INTEGER id PK\n        VARCHAR url\n        VARCHAR title\n        INTEGER duration_in_seconds\n    }\n\n    WATCH_HISTORIES {\n        INTEGER id PK\n        INTEGER user_id FK\n        INTEGER video_id FK\n        TIMESTAMP watched_on\n    }\n\n    ROLES ||--o{ USERS : has\n    USERS ||--|| USER_PROFILES : has\n    USERS ||--o{ WATCH_HISTORIES : watches\n    VIDEOS ||--o{ WATCH_HISTORIES : watched_in"}),"\n",(0,a.jsx)(n.p,{children:"Initial database schema:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"CREATE TABLE roles (\n    id INTEGER PRIMARY KEY,\n    role_type VARCHAR(30) NOT NULL UNIQUE\n);\n\nCREATE TABLE users (\n    id INTEGER PRIMARY KEY,\n    email VARCHAR(255) NOT NULL UNIQUE,\n    username VARCHAR(60) NOT NULL UNIQUE,\n    password_hash VARCHAR(255) NOT NULL,\n    role_id INTEGER NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    last_login TIMESTAMP,\n    FOREIGN KEY (role_id) REFERENCES roles(id)\n);\n\nCREATE TABLE user_profiles (\n    id INTEGER PRIMARY KEY,\n    user_id INTEGER NOT NULL UNIQUE,\n    first_name VARCHAR(60),\n    last_name VARCHAR(100),\n    date_of_birth TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TABLE videos (\n    id INTEGER PRIMARY KEY,\n    url VARCHAR(2048) NOT NULL,\n    title VARCHAR(300) NOT NULL,\n    duration_in_seconds INTEGER NOT NULL\n);\n\nCREATE TABLE watch_histories (\n    id INTEGER PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    video_id INTEGER NOT NULL,\n    watched_on TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"piggyback-learning-api",children:"Piggyback Learning API"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Endpoints"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"- POST /api/verify-password\n- POST /api/download\n- POST /api/frames/{video_id}\n- GET /api/admin/videos\n- POST /api/submit-questions\n- WS /ws/questions/{video_id}\n- GET /api/kids_videos\n- GET /api/final-questions/{video_id}\n- GET /api/videos-list\n- GET /api/expert-questions/{video_id}\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Class Diagram"}),"\nI think we should forgo a class diagram for the api for now:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"It\u2019s written in python therefore has no classes"}),"\n",(0,a.jsx)(n.li,{children:"It\u2019s already developed / difficult to decipher"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Backend"}),"\nYoutube Downloading: Uses yt_dlp to download video, metadata, and subtitles."]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Frontend"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Page rendering :\nFastAPI serves Jinja template from templates/ via JinjaTemplates (somewhere in main)\nMain entry pages (search for them in main.py) :"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"home.html (around line 1021)"}),"\n",(0,a.jsx)(n.li,{children:"children.html(around line 1020-1024?)"}),"\n",(0,a.jsx)(n.li,{children:"expert_preview.html(around line 1049)"}),"\n",(0,a.jsx)(n.li,{children:"admin.html(around line 233)"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Frontend tech:"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'The app UI is rendered as separate HTML files in "templates/"'}),"\n",(0,a.jsx)(n.li,{children:'Each page includes its own "style" and "script" blocks, so behavior and styling live in that file instead of shared JS/CSS bundles.'}),"\n",(0,a.jsx)(n.li,{children:"There is no template inheritance layer, so repeated UI patterns are manually duplicated across pages. (THIS IS BAD)"}),"\n",(0,a.jsx)(n.li,{children:"Result: simple to reason about per page but harder to keep global consistency when changing shared style/interactions."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Data flow:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The browser loads and HTML landing page first. Then uses fetch() to call FastAPI endpoints and update UI dynamically."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Admin page:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Start processing flow(download/frame extraction /question generation) with API calls in admin.html"}),"\n",(0,a.jsx)(n.li,{children:"Opens a Websocket in admin.html , to stream progress update in real time(instead of polling)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Expert page:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Pull available videos/questions and submits review/finalization changes through API calls in expert_preview.html."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Kids page:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Loads the kid-facing catalog and quiz data from backend endpoints in children.html"}),"\n",(0,a.jsx)(n.li,{children:"Calls TTS endpoint for spoken prompts/feedback in children.html."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Static/Media Serving:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"main(main.py) mounts /downloads, so generated assets(videos, extracted frames, question JSON files) are directly reachable by URL."}),"\n",(0,a.jsx)(n.li,{children:"main also mounts /static for normal static resource (JSON/assets used by pages)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Practical meaning to all this: frontend doesn\u2019t need a separate file server; FastAPI serves both APIs and files."}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Serves API endpoints"}),"\n",(0,a.jsx)(n.li,{children:"Serves files like videos/static assets via /downloads and /static"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Important Distinctions:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Documentation/ is a different frontend project: Docusaurus + React."}),"\n",(0,a.jsx)(n.li,{children:"That react site is for docs only and has it own build/runtime flow."}),"\n",(0,a.jsx)(n.li,{children:"Main product UI is not React; it\u2019s server-rendered templates + vanilla JS in the FastAPI app."}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"use-case-sequence-diagrams",children:"Use Case Sequence Diagrams"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Use Case 1 | Answering a Quiz Question"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"As a user, I want to be able to answer quiz questions with voice recognition."})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"A quiz for the video starts and asks the user a question."}),"\n",(0,a.jsx)(n.li,{children:"The user answers vocally, after seeing a visual indication that voice input is being accepted (\u201cyou can speak now!\u201d or something like that)."}),"\n",(0,a.jsx)(n.li,{children:"The user's input is mapped to an answer for the quiz."}),"\n",(0,a.jsx)(n.li,{children:"If incorrect, a fallback option is triggered. Potentially a multiple-choice quiz."}),"\n",(0,a.jsx)(n.li,{children:"If correct, the video continues playing."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Use Case 2 | Assign videos"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"As a parent, I want to search for other users(kid accounts) so I can assign videos and quizzes to them."})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"The parent opens up a search bar and type in a username/email."}),"\n",(0,a.jsx)(n.li,{children:"The system displays matching accounts."}),"\n",(0,a.jsx)(n.li,{children:"The parent selects the user and types the video name into another search bar for videos."}),"\n",(0,a.jsx)(n.li,{children:"The system displays matching videos."}),"\n",(0,a.jsx)(n.li,{children:"The parent then clicks on the video and a menu pops up."}),"\n",(0,a.jsx)(n.li,{children:"From the menu, the parent chooses fallback options, toggles no distraction mode, and assigns it to the user."}),"\n",(0,a.jsx)(n.li,{children:"User receives the video and gets notified."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Use Case 3 | View Dashboard"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"As a user/parent, I want a dashboard so I can view the history and quiz performance."})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"The user clicks on the button for dashboard."}),"\n",(0,a.jsx)(n.li,{children:"The application makes a request to the database for information about the user\u2019s history and quiz performances."}),"\n",(0,a.jsx)(n.li,{children:"The application receives the data and places it into a dashboard."}),"\n",(0,a.jsx)(n.li,{children:"The dashboard is then shown to the user."}),"\n",(0,a.jsx)(n.li,{children:"The user is able to click on individual videos from the dashboard to see detailed stats for past videos watched."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);